<mvc:View
    controllerName="vcp.vcplannerdashboard.controller.View1"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:m="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:uxap="sap.uxap"
    xmlns:card="sap.ui.integration.widgets"
    xmlns:viz="sap.viz.ui5.controls"
    xmlns:viz.data="sap.viz.ui5.data"
    xmlns:table="sap.ui.table"
    xmlns:vizFeeding="sap.viz.ui5.controls.common.feeds"
    xmlns:html="http://www.w3.org/1999/xhtml"
    xmlns:f="sap.f"
    height="100%">

    <uxap:ObjectPageLayout
        id="ObjectPageLayout"
        showTitleInHeaderContent="true"
        useIconTabBar="false"
        alwaysShowContentHeader="true"
        showAnchorBar="true"
        enableLazyLoading="false"
        upperCaseAnchorBar="false">
        <!-- === HEADER ============================================== -->
        <uxap:headerTitle>
            <uxap:ObjectPageDynamicHeaderTitle class="header">
                <uxap:expandedHeading>
                    <m:VBox width="100%">
                        <m:HBox class="header-top" alignItems="Center" justifyContent="SpaceBetween" width="100%">
                            <!-- === Logo and Title === -->
                            <m:HBox class="logo-section" alignItems="Center">
                                <m:Image class="logo" id="idHeaderImage" />
                                <m:VBox class="title-section">
                                    <m:Title text="VC Planner Dashboard" level="H1" />
                                    <m:Text text="Sales &amp; Operations Planning for Configurable Products" />
                                </m:VBox>
                                <!-- === Variant Management === -->
                                <m:VariantManagement
                                    id="idMatListVPD"
                                    select="handleSelectPress"
                                    save="onCreate"
                                    manage="onManage"
                                    supportFavorites="false"
                                    showFooter="true"
                                    popoverTitle="My Views"
                                    items="{viewDetails>/items12}"
                                    creationAllowed="true"
                                    supportPublic="true"
                                    supportApplyAutomatically="false"
                                    manageCancel="onManageCancel"
                                    cancel="onNameCancel"
                                    visible="true">
                                    <m:items>
                                        <m:VariantItem
                                            key="{viewDetails>VARIANTID}"
                                            text="{viewDetails>VARIANTNAME}"
                                            author="{viewDetails>USER}"
                                            visible="true"
                                            remove="{path:'viewDetails>REMOVE', formatter:'.formatter.formatRemove'}"
                                            sharing="{viewDetails>SCOPE}"
                                            changeable="{path:'viewDetails>CHANGE', formatter:'.formatter.formatChange'}"
                                            rename="false"
                                            enabled="{path:'viewDetails>ENABLE', formatter:'.formatter.formatEnable'}" />
                                    </m:items>
                                </m:VariantManagement>
                            </m:HBox>
                            <!-- === Filters and Buttons === -->
                            <m:HBox class="controls" alignItems="Center" justifyContent="End">
                                <m:VBox class="control-group">
                                    <m:Label text="Location" />
                                    <m:ComboBox
                                        id="LocationSelect"
                                        items="{locModel>/results1}"
                                        showSecondaryValues="true"
                                        selectionChange=".onLocationChange"
                                        placeholder="Select Location" required="true">
                                        <core:ListItem
                                            key="{locModel>DEMAND_LOC}"
                                            text="{locModel>DEMAND_DESC}"
                                            additionalText="{locModel>DEMAND_LOC}" />
                                    </m:ComboBox>
                                </m:VBox>

                                <m:VBox class="control-group">
                                    <m:Label text="Product" />
                                    <m:ComboBox
                                        id="productSelect"
                                        items="{prodModel>/results2}"
                                        showSecondaryValues="true"
                                        selectionChange=".onProductChange"
                                        placeholder="Select Product" required="true">
                                        <core:ListItem
                                            key="{prodModel>PRODUCT_ID}"
                                            text="{prodModel>PROD_DESC}"
                                            additionalText="{prodModel>PRODUCT_ID}" />
                                    </m:ComboBox>
                                </m:VBox>

                                <m:VBox>
                                    <m:Label text="" />
                                    <m:Button id="idBtnPD" press="onGetData" text="Go" type="Emphasized" />
                                </m:VBox>

                                <m:VBox>
                                    <m:Label text="" />
                                    <m:Button id="idResetPD" press="onResetData" text="Reset" />
                                </m:VBox>

                                <m:VBox>
                                    <m:Label text="" />
                                    <m:Button id="idWidget" press="onAdaptWidgets" text="Adapt Widgets" />
                                </m:VBox>
                            </m:HBox>
                        </m:HBox>
                    </m:VBox>
                </uxap:expandedHeading>
            </uxap:ObjectPageDynamicHeaderTitle>
        </uxap:headerTitle>
        <!-- === SECTIONS ============================================ -->
        <uxap:sections>
            <!-- ðŸŸ¦ Alerts Section -->
            <uxap:ObjectPageSection id="alertsPanel" title="Alerts">
                <uxap:subSections>
                    <uxap:ObjectPageSubSection>
                        <uxap:blocks>
                            <m:VBox width="100%">
                                <m:HBox class="card-container" alignItems="Start" justifyContent="SpaceBetween" wrap="Wrap">
                                    <m:VBox class="card-wrapper smallCard" width="30%">
                                        <card:Card id="MyCardId" height="400px" />
                                    </m:VBox>
                                    <m:VBox class="card-wrapper largeCard" width="69%">
                                        <card:Card id="MyCardId3" height="400px" />
                                    </m:VBox>
                                </m:HBox>

                                <m:HBox class="card-container" alignItems="Start" justifyContent="SpaceBetween" wrap="Wrap">
                                    <m:VBox class="card-wrapper" width="49%">
                                        <card:Card id="MyCardId1" height="400px" width="100%" />
                                    </m:VBox>
                                    <m:VBox class="card-wrapper" width="50%">
                                        <card:Card id="MyCardId4" height="400px" width="100%" />
                                    </m:VBox>
                                </m:HBox>
                            </m:VBox>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>
            <!-- ðŸŸ© Forecast Accuracy Section -->
            <uxap:ObjectPageSection id="lagsPanel" title="Forecast Accuracy">
                <uxap:subSections>
                    <uxap:ObjectPageSubSection>
                        <uxap:blocks>
                           <m:VBox width="100%">
                        <m:HBox class="sapUiMediumMarginBottom"
                              alignItems="Start"
                              justifyContent="SpaceBetween"
                              wrap="Wrap">
                            <m:items>        
                                <m:VBox width="99%" class="lag-box lag-assembly sapUiSmallMarginEnd sapUiSmallMarginBottom">
                                    <m:Title text="Forecast Accuracy" level="H3" class="sapUiSmallMarginBottom" />
                                    <m:HBox alignItems="Center" justifyContent="Start" class="sapUiSmallMarginBottom">
                                        <m:items>
                                            <m:VBox>
                                                <m:Label id="idFac" text="Manufacturing Location" required="true"/>
                                                <m:ComboBox id="cbFactory"
                                                          items="{location>/Location}"
                                                          showSecondaryValues="true"
                                                          selectionChange=".onFacLocChange"
                                                          placeholder="Select Manufacturing Location">
                                                    <core:ListItem key="{location>FACTORY_LOC}"
                                                                   text="{location>LOCATION_DESC}"
                                                                   additionalText="{location>FACTORY_LOC}" />
                                                </m:ComboBox>
                                            </m:VBox>
                                            <m:VBox>
                                                <m:Label id="idAss" text="Start Month" required="true"/>
                                                <m:ComboBox id="cbStartMonth"
                                                          items="{calendarStart>/MONTHDATA}"
                                                          showSecondaryValues="true"
                                                          selectionChange=".onAssemblyChange"
                                                          placeholder="Select Start Month">
                                                    <core:ListItem key="{calendarStart>PERIODDESC}" text="{calendarStart>PERIODDESC}" />
                                                </m:ComboBox>
                                            </m:VBox>
                                            <m:VBox>
                                                <m:Label id="idMonth" text="End Month" required="true"/>
                                                <m:ComboBox id="cbEndMonth"
                                                          items="{calendarEnd>/MONTHDATAEND}"
                                                          showSecondaryValues="true"
                                                          selectionChange=".onGo"
                                                          placeholder="Select End Month">
                                                    <core:ListItem key="{calendarEnd>PERIODDESC}" text="{calendarEnd>PERIODDESC}" />
                                                </m:ComboBox>
                                            </m:VBox>
                                        </m:items>
                                    </m:HBox>                                  

                                     <m:VBox id="pivotPageLag">
                <m:OverflowToolbar id="idPivotToolBarLag" height="12%" visible="{= ${oGModel>/showPivot} }">
                <m:Label text="Lags Type:" design="Bold"></m:Label>
                    <m:ComboBox id="idTypeBox" selectedKey="Assembly" selectionChange="onChnageType">
                        <core:Item key="Assembly" text="Assembly" />
                        <core:Item key="Product" text="Product Demand" />
                        <core:Item key="Restriction" text="Resource Consumption" />
                        <core:Item key="Characteristic" text="Characteristic" />
                        <core:Item key="StatFore" text="Statastical Forecast" />
                    </m:ComboBox>
                    <m:CheckBox id="idFilterCheck" selected="false" text="Show Filter" select="onFilter"></m:CheckBox>
                    <m:Button text="Key Figure" id="idkeyFig" press="onPressKey"></m:Button>
                    <m:ToolbarSpacer />
                    <m:RadioButtonGroup id="idMapTypeGroup" columns="3" selectedIndex="0" select="onSelectMapType">
                        <m:RadioButton id="idMapBox" text="MAPE" />
                        <m:RadioButton id="idLagQtyBox" text="Lag Quantity" />
                        <m:RadioButton id="idMapQtyBox" text="MAPE Quantity" />
                    </m:RadioButtonGroup>
                </m:OverflowToolbar>

                <table:Table id="myTableLag" visible="{= !${oGModel>/showPivot} }" width="100%">
                </table:Table>
                <html:div id="mainDivLag" class = "mainDivClass"/>
            </m:VBox>
             <!-- ðŸŸ¦ Assembly Planner List -->
<m:VBox class="sapUiSmallMarginBottom">
    <m:Title text="Assemblies without Planning" level="H4" class="sapUiSmallMarginBottom"/>

    <f:GridList
        id="assemblyGrid"
        items="{assemblyModel>/assemblies}"
        mode="None">
        <m:CustomListItem>
            <m:HBox
                class="sapUiTinyMargin sapUiSmallMarginEnd"
                alignItems="Center"
                justifyContent="SpaceBetween"
                width="100%">
                <m:VBox>
                    <m:ObjectIdentifier
                        title="{assemblyModel>assembly}"
                    />
                    <m:ObjectStatus
                        state="Warning"
                        text="{assemblyModel>desc}"
                    />
                </m:VBox>
            </m:HBox>
        </m:CustomListItem>
    </f:GridList>
</m:VBox>
                                </m:VBox>
                            </m:items>
                        </m:HBox>
                    </m:VBox>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>
            <!-- ðŸŸ¨ WoW Variance Section -->
            <uxap:ObjectPageSection id="idRow4" title="WoW Variance">
                <uxap:subSections>
                    <uxap:ObjectPageSubSection>
                        <uxap:blocks>
                            <m:HBox
                                id="idRow5"
                                class="card-container wow-panel sapUiMediumMarginBottom"
                                alignItems="Start"
                                justifyContent="SpaceBetween"
                                wrap="Wrap">
                                <m:VBox class="card-wrapper" width="99%">
                                    <m:Title text="WoW Variance Analysis" level="H3" class="sapUiSmallMarginBottom" />
                                    <m:HBox alignItems="Center" justifyContent="Start" class="sapUiSmallMarginBottom">
                                    <m:items>
                                        <m:VBox>
                                            <m:Label text="Type" required="true" />
                                            <m:ComboBox id="idWOW"
                                                      items="{wowModel>/options}"
                                                      selectedKey="{wowModel>/selectedKey}"
                                                      showSecondaryValues="true"
                                                      placeholder="Select Type"
                                                      selectionChange=".onTypeChange">
                                                <core:ListItem key="{wowModel>key}" text="{wowModel>text}" />
                                            </m:ComboBox>
                                        </m:VBox>
                                        <m:VBox>
                                            <m:Label text="Variance" required="true"/>
                                            <m:ComboBox id="idVariance"
                                                      items="{wowModelVariance>/Variance}"
                                                      selectedKey="{wowModelVariance>/selectedKey}"
                                                      showSecondaryValues="true"
                                                      placeholder="Select Variance"
                                                      selectionChange=".onVarianceChange">
                                                <core:ListItem key="{wowModelVariance>key}" text="{wowModelVariance>text}" />
                                            </m:ComboBox>
                                        </m:VBox>
                                    </m:items>
                                </m:HBox>
                                    <viz:VizFrame
                                        id="MyCardIdFore"
                                        uiConfig="{applicationSet:'fiori'}"
                                        vizType="column"
                                        height="400px"
                                        width="100%">
                                        <viz:dataset>
                                            <viz.data:FlattenedDataset data="{wowVariance>/wowVarianceType}">
                                                <viz.data:dimensions>
                                                    <viz.data:DimensionDefinition name="Week Desc" value="{wowVariance>THIS_WEEK_DATE}" />
                                                </viz.data:dimensions>
                                                <viz.data:measures>
                                                    <viz.data:MeasureDefinition name="Percentage Variance" value="{wowVariance>PERCENT_DIFF_WOW}" />
                                                </viz.data:measures>
                                            </viz.data:FlattenedDataset>
                                        </viz:dataset>
                                        <viz:feeds>
                                            <vizFeeding:FeedItem uid="categoryAxis" type="Dimension" values="Week Desc" />
                                            <vizFeeding:FeedItem uid="valueAxis" type="Measure" values="Percentage Variance" />
                                        </viz:feeds>
                                    </viz:VizFrame>
                                </m:VBox>
                            </m:HBox>
                        </uxap:blocks>
                    </uxap:ObjectPageSubSection>
                </uxap:subSections>
            </uxap:ObjectPageSection>
        </uxap:sections>
    </uxap:ObjectPageLayout>
    <!-- Floating Quick Help Button -->
    <m:Button
        id="quickHelpRibbon"
        text="Quick Help"
        icon="sap-icon://sys-help"
        press="onOpenQuickHelp"
        class="quickHelpRibbon"
         />
</mvc:View>
