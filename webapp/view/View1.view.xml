<mvc:View controllerName="vcp.vcplannerdashboard.controller.View1"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:card="sap.ui.integration.widgets" 
    xmlns:viz="sap.viz.ui5.controls"
    xmlns:f="sap.f"
    xmlns:smartfilterbar="sap.ui.comp.smartfilterbar"
xmlns:vizFeeding="sap.viz.ui5.controls.common.feeds">

    <Page id="page" title="{i18n>title}" showHeader="false">
        <content>

            <!-- HEADER SECTION -->
            <VBox class="header">
                <HBox class="header-top" alignItems="Center" justifyContent="SpaceBetween">

                    <!-- Logo & Title -->
                    <HBox class="logo-section" alignItems="Center">
                        <Image class="logo" id="idHeaderImage" />
                        <VBox class="title-section">
                            <Title text="VC Planner Dashboard" level="H1" />
                            <Text text="Sales &amp; Operations Planning for Configurable Products" />
                        </VBox>
                         <!-- <VariantManagement xmlns="sap.m" id="idMatList123VPD" select="handleSelectPress" save="onCreate" manage="onManage" supportFavorites="false" showFooter="true" popoverTitle="My Views" items="{path: '/items12'}" creationAllowed="true" supportPublic="true" supportApplyAutomatically="false" manageCancel="onManageCancel" cancel="onNameCancel" visible="false">
                        <items>
                            <VariantItem key="{VARIANTID}" text="{VARIANTNAME}" author="{USER}" visible="true" remove="{path:'REMOVE', formatter:'.formatter.formatRemove'}" sharing="{SCOPE}" changeable="{path:'CHANGE', formatter:'.formatter.formatChange'}" rename="false" enabled="{path:'ENABLE', formatter:'.formatter.formatEnable'}"/>
                        </items>
                    </VariantManagement> -->
                    </HBox>

                    <!-- Controls -->
                    <HBox class="controls" alignItems="Center" justifyContent="End">
                        <VBox class="control-group">
                            <Label text="Location" />
                            <ComboBox id="LocationSelect" items="{locModel>/results1}" showSecondaryValues="true"
                                selectionChange=".onLocationChange" placeholder="Select Location">
                                <core:ListItem key="{locModel>DEMAND_LOC}" text="{locModel>DEMAND_DESC}" additionalText="{locModel>DEMAND_LOC}" />
                            </ComboBox>
                        </VBox>

                        <VBox class="control-group">
                            <Label text="Product" />
                            <ComboBox id="productSelect" items="{prodModel>/results2}" showSecondaryValues="true"
                                selectionChange=".onProductChange" placeholder="Select Product">
                                <core:ListItem key="{prodModel>PRODUCT_ID}" text="{prodModel>PROD_DESC}" additionalText="{prodModel>PRODUCT_ID}" />
                            </ComboBox>
                        </VBox>

                        <VBox>
                            <Label text="" />
                            <Button id="idBtnPD" press="onGetData" text="Go" type="Emphasized" />
                        </VBox>

                        <VBox>
                            <Label text="" />
                            <Button id="idResetPD" press="onResetData" text="Reset" />
                        </VBox>

                        <VBox>
                            <Label text="" />
                            <Button id="idWidget" press="onAdaptWidgets" text="Adapt Widgets" />
                        </VBox>
                    </HBox>
                </HBox>
            </VBox>

            <!-- MAIN CONTENT -->
            <VBox class="main-dashboard" justifyContent="Start" width="100%">
             <Button id="quickHelpRibbon"
                                        text="Quick Help"
                                        icon="sap-icon://sys-help"
                                        press="onOpenQuickHelp"
                                        class="quickHelpRibbon"/>
                                        
                 <!-- Alerts Panel -->
                <Panel id="alertsPanel"
                       headerText="Alerts"
                       expandable="true"
                       expanded="true"
                       width="100%"
                       class="sapUiNoContentPadding sapUiMediumMarginBottom">

                    <VBox width="100%">
                        <!-- ROW 1 -->
                        <HBox class="card-container" alignItems="Start" justifyContent="SpaceBetween" wrap="Wrap">
                            <items>
                                <VBox class="card-wrapper smallCard" width="30%">
                                    <items>
                                        <card:Card id="MyCardId" height="400px" />
                                    </items>
                                </VBox>

                                <VBox class="card-wrapper largeCard" width="69%">
                                    <items>
                                        <card:Card id="MyCardId3" height="400px" />
                                    </items>
                                </VBox>

                               
                            </items>
                        </HBox>

                        <!-- ROW 2 -->
                        <HBox class="card-container" alignItems="Start" justifyContent="SpaceBetween" wrap="Wrap">
                            <items>
                                <VBox class="card-wrapper" width="49%">
                                    <items>
                                        <card:Card id="MyCardId1" height="400px" width="100%" />
                                    </items>
                                </VBox>
                                <VBox class="card-wrapper" width="50%">
                                    <items>
                                        <card:Card id="MyCardId4" height="400px" width="100%" />
                                    </items>
                                </VBox>
                            </items>
                        </HBox>
                    </VBox>
                </Panel>

<!-- ========================================================= -->
<!-- ===== LAGS DISPLAY SECTION (2x2 Grid) =================== -->
<!-- ========================================================= -->
<Panel id="lagsPanel"
       headerText="Lags"
       expandable="true"
       expanded="false"
       width="100%"
       class="sapUiNoContentPadding sapUiMediumMarginBottom">

    <VBox width="100%">

        <!-- ========== ROW 1: Assembly + Procurement ========== -->
        <HBox class="sapUiMediumMarginBottom"
              alignItems="Start"
              justifyContent="SpaceBetween"
              wrap="Wrap">
            <items>

                <!-- ==== ASSEMBLY LAG ==== -->
                <VBox width="49%" class="sapUiSmallMarginEnd sapUiSmallMarginBottom">
                    <Title text="Assembly Lag Analysis" level="H3" class="sapUiSmallMarginBottom" />
                    <HBox alignItems="Center" justifyContent="Start" class="sapUiSmallMarginBottom">
                        <items>
                            <VBox >
                                <Label id="idFac" text="Factory Location" required="true"></Label>
                 <ComboBox id="cbFactory" items="{filters>/Factory_loc}" showSecondaryValues="true"
                                selectionChange=".onFacLocChange" placeholder="Select Factory Location">
                                <core:ListItem key="{filters>FACTORY_LOC}" text="{filters>LOCATION_DESC}"
                                    additionalText="{filters>FACTORY_LOC}" />
                            </ComboBox>
                              </VBox>
                               <VBox>
            <Label id="idAss" text="Assembly" required="true"></Label>
                            <ComboBox id="cbAssembly" items="{assembly>/Assembly}" showSecondaryValues="true"
                                selectionChange=".onAssemblyChange" placeholder="Select Assembly">
                                <core:ListItem key="{assembly>ASSEMBLY}" text="{assembly>ASSEMBLY}"
                                    />
                            </ComboBox>
                            </VBox>
                             <VBox>
            <Label id="idMonth" text="Month" required="true"></Label>
                             <ComboBox id="cbMonth" items="{calendar>/MONTH}" showSecondaryValues="true"
                                selectionChange=".onAssemblyGo" placeholder="Select Month">
                                <core:ListItem key="{calendar>MONTH}" text="{calendar>MONTH}"
                                    />
                            </ComboBox>
                             </VBox>
                        </items>
                    </HBox>

                    <viz:VizFrame id="idWFModel"
                                  uiConfig="{applicationSet:'fiori'}"
                                  vizType="waterfall"
                                  height="400px"
                                  width="100%">
                        <viz:dataset>
                            <viz.data:FlattenedDataset
                                xmlns:viz.data="sap.viz.ui5.data"
                                data="{waterfallModel>/WaterfallData}">
                                <viz.data:dimensions>
                                    <viz.data:DimensionDefinition name="Lag" value="{waterfallModel>LAG_MONTH}" />
                                </viz.data:dimensions>
                                <viz.data:measures>
                                    <viz.data:MeasureDefinition name="Mape" value="{waterfallModel>MAPE}" />
                                </viz.data:measures>
                            </viz.data:FlattenedDataset>
                        </viz:dataset>
                        <viz:feeds>
                            <vizFeeding:FeedItem uid="categoryAxis" type="Dimension" values="Lag" />
                            <vizFeeding:FeedItem uid="valueAxis" type="Measure" values="Mape" />
                        </viz:feeds>
                    </viz:VizFrame>
                </VBox>

                <!-- ==== Option Mix LAG ==== -->
                <VBox width="49%" class="sapUiSmallMarginBottom">
                    <Title text="Option Mix Lag Analysis" level="H3" class="sapUiSmallMarginBottom" />
                    <HBox alignItems="Center" justifyContent="Start" class="sapUiSmallMarginBottom">
                        <items>
                            <VBox>
                                <Label text="Factory Location" required="true"/>
                                <ComboBox id="cbFactoryPL" items="{filters>/Factory_loc}" showSecondaryValues="true" selectionChange="onOptFacChange">
                                    <core:ListItem key="{filters>FACTORY_LOC}"
                                                   text="{filters>LOCATION_DESC}"
                                                   additionalText="{filters>FACTORY_LOC}" />
                                </ComboBox>
                            </VBox>
                            <VBox>
                                <Label text="Month" required="true"/>
                                <ComboBox id="cbMonthPL" items="{calendarOpt>/Month}" showSecondaryValues="true" selectionChange="onOptMonthChange">
                                    <core:ListItem key="{calendarOpt>MONTH}" text="{calendarOpt>MONTH}" />
                                </ComboBox>
                            </VBox>
                             <VBox>
                                <Label text="Char." required="true"/>
                                <ComboBox id="cbCharPL" items="{characteristic>/CHARA_NUM}" showSecondaryValues="true" selectionChange="onOptCharChange">
                                    <core:ListItem key="{characteristic>CHAR_NUM}" text="{characteristic>CHAR_NUM}" />
                                </ComboBox>
                            </VBox>
                            <VBox>
                                <Label text="Char. Value" required="true"/>
                                <ComboBox id="cbCharValPL" items="{characteristicValue>/CHARA_VALUE}" showSecondaryValues="true" selectionChange="onOptMixGo">
                                    <core:ListItem key="{characteristicValue>CHAR_VALUE}" text="{characteristicValue>CHAR_VALUE}" />
                                </ComboBox>
                            </VBox>
                        </items>
                    </HBox>

                    <viz:VizFrame id="idOptMixWF"
                                  uiConfig="{applicationSet:'fiori'}"
                                  vizType="waterfall"
                                  height="400px"
                                  width="100%">
                        <viz:dataset>
                            <viz.data:FlattenedDataset
                                xmlns:viz.data="sap.viz.ui5.data"
                                data="{waterfallModelOpt>/WaterfallDataOpt}">
                                <viz.data:dimensions>
                                    <viz.data:DimensionDefinition name="Lag" value="{waterfallModelOpt>LAG_MONTH}" />
                                </viz.data:dimensions>
                                <viz.data:measures>
                                    <viz.data:MeasureDefinition name="Mape" value="{waterfallModelOpt>MAPE}" />
                                </viz.data:measures>
                            </viz.data:FlattenedDataset>
                        </viz:dataset>
                        <viz:feeds>
                            <vizFeeding:FeedItem uid="categoryAxis" type="Dimension" values="Lag" />
                            <vizFeeding:FeedItem uid="valueAxis" type="Measure" values="Mape" />
                        </viz:feeds>
                    </viz:VizFrame>
                </VBox>

            </items>
        </HBox>

        <!-- ========== ROW 2: Production + Dispatch ========== -->
        <HBox alignItems="Start"
              justifyContent="SpaceBetween"
              wrap="Wrap">
            <items>

                <!-- ==== Rtr LAG ==== -->
                <VBox width="49%" class="sapUiSmallMarginEnd sapUiSmallMarginBottom">
                    <Title text="Restriction Lag Analysis" level="H3" class="sapUiSmallMarginBottom" />
                    <HBox alignItems="Center" justifyContent="Start" class="sapUiSmallMarginBottom">
                        <items>
                            <VBox>
                                <Label text="Factory Location" required="true"/>
                                <ComboBox id="cbFactoryPR" items="{filters>/Factory_loc}" showSecondaryValues="true" selectionChange="onRtrLocChange">
                                    <core:ListItem key="{filters>FACTORY_LOC}"
                                                   text="{filters>LOCATION_DESC}"
                                                   additionalText="{filters>FACTORY_LOC}" />
                                </ComboBox>
                            </VBox>
                            <VBox>
                                <Label text="Month" required="true"/>
                                <ComboBox id="cbMonthPR" items="{calendarRtr>/MonthRtr}" showSecondaryValues="true" selectionChange="onRtrMonthChange">
                                    <core:ListItem key="{calendarRtr>MONTH}" text="{calendarRtr>MONTH}" />
                                </ComboBox>
                            </VBox>
                             <VBox>
                                <Label text="Line" required="true"/>
                                <ComboBox id="cbLinePR" items="{LINEIDRT>/LINEIDRTR}" showSecondaryValues="true" selectionChange="onRtrLineChange">
                                    <core:ListItem key="{LINEIDRT>LINE_ID}" text="{LINEIDRT>LINE_ID}" />
                                </ComboBox>
                            </VBox>
                            <VBox>
                                <Label text="Restriction ID" required="true"/>
                                <ComboBox id="cbRstrPR" items="{RTRID>/RTR_ID}" showSecondaryValues="true" selectionChange="onRtrGo">
                                    <core:ListItem key="{RTRID>RESTRICTION}" text="{RTRID>RESTRICTION}" />
                                </ComboBox>
                            </VBox>
                        </items>
                    </HBox>

                    <viz:VizFrame id="idRTRWF"
                                  uiConfig="{applicationSet:'fiori'}"
                                  vizType="waterfall"
                                  height="400px"
                                  width="100%">
                        <viz:dataset>
                            <viz.data:FlattenedDataset
                                xmlns:viz.data="sap.viz.ui5.data"
                                data="{rtrLagModel>/WaterfallDataRTR}">
                                <viz.data:dimensions>
                                    <viz.data:DimensionDefinition name="Lag" value="{rtrLagModel>LAG_MONTH}" />
                                </viz.data:dimensions>
                                <viz.data:measures>
                                    <viz.data:MeasureDefinition name="Mape" value="{rtrLagModel>MAPE}" />
                                </viz.data:measures>
                            </viz.data:FlattenedDataset>
                        </viz:dataset>
                        <viz:feeds>
                            <vizFeeding:FeedItem uid="categoryAxis" type="Dimension" values="Lag" />
                            <vizFeeding:FeedItem uid="valueAxis" type="Measure" values="Mape" />
                        </viz:feeds>
                    </viz:VizFrame>
                </VBox>

                <!-- ==== PRD DMD LAG ==== -->
                <VBox width="49%" class="sapUiSmallMarginBottom">
                    <Title text="Product Demand Lag analysis" level="H3" class="sapUiSmallMarginBottom" />
                    <HBox alignItems="Center" justifyContent="Start" class="sapUiSmallMarginBottom">
                        <items>
                            <VBox>
                                <Label text="Factory Location" required="true" />
                                <ComboBox id="cbFactoryDL" items="{filters>/Factory_loc}" showSecondaryValues="true" selectionChange="onPrdDmdLocChange">
                                    <core:ListItem key="{filters>FACTORY_LOC}"
                                                   text="{filters>LOCATION_DESC}"
                                                   additionalText="{filters>FACTORY_LOC}" />
                                </ComboBox>
                            </VBox>
                            <VBox>
                                <Label text="Month" required="true"/>
                                <ComboBox id="cbMonthDL" items="{calendarPrdDmd>/MonthPrd}" showSecondaryValues="true" selectionChange="onPrdDmdGo">
                                    <core:ListItem key="{calendarPrdDmd>MONTH}" text="{calendarPrdDmd>MONTH}" />
                                </ComboBox>
                            </VBox>
                        </items>
                    </HBox>

                    <viz:VizFrame id="idPRDDMDWF"
                                  uiConfig="{applicationSet:'fiori'}"
                                  vizType="waterfall"
                                  height="400px"
                                  width="100%">
                        <viz:dataset>
                            <viz.data:FlattenedDataset
                                xmlns:viz.data="sap.viz.ui5.data"
                                data="{prddmdLagModel>/WaterfallDataPrdDmd}">
                                <viz.data:dimensions>
                                    <viz.data:DimensionDefinition name="Lag" value="{prddmdLagModel>LAG_MONTH}" />
                                </viz.data:dimensions>
                                <viz.data:measures>
                                    <viz.data:MeasureDefinition name="Mape" value="{prddmdLagModel>MAPE}" />
                                </viz.data:measures>
                            </viz.data:FlattenedDataset>
                        </viz:dataset>
                        <viz:feeds>
                            <vizFeeding:FeedItem uid="categoryAxis" type="Dimension" values="Lag" />
                            <vizFeeding:FeedItem uid="valueAxis" type="Measure" values="Mape" />
                        </viz:feeds>
                    </viz:VizFrame>
                </VBox>

            </items>
        </HBox>

    </VBox>
</Panel>

                <!-- ROW 4 -->
                <HBox class="card-container" alignItems="Start" justifyContent="SpaceBetween" wrap="Wrap" id="idRow4">
                    <items>
                        <VBox class="card-wrapper" width="25%">
                            <items>
                                 <card:Card id="MyCardId2" height="400px" width="100%" />
                                 
                            </items>
                        </VBox>
                        <VBox class="card-wrapper" width="74%">
                            <items>
                        <card:Card id="MyCardIdFore" height="400px" width="100%" />
                         </items>
                        </VBox>
                    </items>
                </HBox>
            </VBox>
        </content>
    </Page>
</mvc:View>
